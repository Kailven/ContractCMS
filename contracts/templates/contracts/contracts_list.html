{% extends 'base/base.html' %}
{% load contracts_tag %}
{% block title %}
    合同列表
{% endblock %}

{% block nav %}
    {% include 'base/nav.html' %}
{% endblock %}

{% block main %}
    <div class="grid-container fluid full">
        <div class="grid-x">
            {#侧边栏部分,采用Accordion样式菜单#}
            <div class="cell large-2 text-center">
                <ul class="accordion" data-accordion data-allow-all-closed="true">
                    <li class="accordion-item is-active" data-accordion-item>
                        <a href="#" class="accordion-title rem-1">合同种类</a>
                        <div class="accordion-content" data-tab-content>
                            <a href="{% url 'contracts:contract_list' %}">全部</a>
                            {% for subject in subjects %}
                                <hr class="hide-for-small-only">
                                <br class="show-for-small-only">
                                <a href="{% url 'contracts:contract_list_subject' subject.id %}">{{ subject.full_name }}</a>
                            {% endfor %}
                        </div>
                    </li>

                    <li class="accordion-item" data-accordion-item>
                        <a href="/" class="accordion-title rem-1">可用操作</a>
                        <div class="accordion-content" data-tab-content>
                            <a href="{% url 'contracts:contract_add' %}">新增合同</a>
                        </div>
                    </li>
                </ul>
            </div>
            {#主体部分,采用表格#}
            <div class="cell large-10 ">
                <div class="grid-x grid-padding-x text-center">
                    <div class="cell">
                        {% if contracts.count %}
                            <h1><span class="primary-color">{% if subject %}{{ subject.name }}{% endif %}</span>合同列表
                            </h1>

                            <table class="hover stack">
                                <thead>
                                <tr>
                                    <th class="text-center">索引</th>
                                    <th class="text-center"><span data-tooltip tabindex="1" title="点击合同名进入详情页">合同名称</span></th>
                                    <th class="text-center">供应商名称</th>
                                    <th class="text-center">合同金额</th>
                                    <th class="text-center">决算金额</th>
                                    <th class="text-center hide-for-small-only">签订时间</th>
                                    <th class="text-center hide-for-small-only">有效</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for contract in contracts %}

                                    <tr>
                                        <td class="text-center hide-for-large">{{ contract.index }}</td>
                                        <td class="text-left show-for-large">{{ contract.index }}</td>
                                        <td><a href="{{ contract.get_absolute_url }}">{{ contract.name }}</a></td>
                                        <td>{{ contract.supplier }}</td>
                                        <td>{{ contract.amount|comma }}</td>
                                        <td>{% if contract.definite %}{{ contract.definite|comma }}{% endif %}</td>
                                        <td class="hide-for-small-only">{{ contract.sign|date:"Y-m-d" }}</td>
                                        <td class="hide-for-small-only">
                                            {% if contract.active %} <i class="fi-check success-color"></i>
                                            {% else %}<i class="fi-x alert-color"></i>
                                            {% endif %}
                                        </td>
                                    </tr>
                                    {% if contract.supple_contracts %}
                                        {% for supple in contract.supple_contracts %}
                                            <tr>
                                        <td class="text-center hide-for-large">{{ supple.index }}</td>
                                        <td class="text-left show-for-large">{{ supple.index }}</td>
                                        <td><a href="{{ supple.get_absolute_url }}">{{ supple.name }}</a></td>
                                        <td>{{ supple.supplier }}</td>
                                        <td>{{ supple.amount|comma }}</td>
                                        <td>{% if supple.definite %}{{ supple.definite|comma }}{% endif %}</td>
                                        <td class="hide-for-small-only">{{ supple.sign|date:"Y-m-d" }}</td>
                                        <td class="hide-for-small-only">
                                            {% if supple.active %} <i class="fi-check success-color"></i>
                                            {% else %}<i class="fi-x alert-color"></i>
                                            {% endif %}
                                        </td>
                                    </tr>
                                        {% endfor %}

                                    {% endif %}
                                {% endfor %}
                                </tbody>
                            </table>
                        {% else %}
                            <h1><span class="primary-color">{% if subject %}{{ subject.name }}{% else %}
                                全部{% endif %}</span>类别下无任何合同</h1>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}